{{ extends 'global/Page.html' }}
{{ block title }}Card Game{{ endblock }}

{{ block content }}

<style>
    #cards_container {
        display: flex;
        justify-content: space-around;
        margin-bottom: 2rem;
    }
    .btn-card {
        width: 100px;
        height: 150px;
        font-size: 30px;
    }
    #on-selection {
        display: none;
    }
    #on-selection p:first-child {
        font-size: 20px;
    }
    #card_selected {
        font-weight: bold;
    }
</style>

<div id="cards_container">
    {{ for card in cards }}
        <div>
            <button type="button" value="{{ card }}" class="btn-card">
                {{ card }}
            </button>
        </div>
    {{ endfor }}
</div>

<input type="hidden" name="card">
{{ formfield_errors 'card' }}

<div id="on-selection">
    <p>
        Your chosen card is <span id="card_selected"></span>
    </p>
    <p>
        <button class="btn btn-primary otree-btn-next">
            Submit
        </button>
    </p>
</div>

{{ endblock }}

{{ block scripts }}
<script>
    window.onload = () => {
        let buttons = document.querySelectorAll('.btn-card'),
            cardInput = document.querySelector('input[name="card"]'),
            onSelection = document.getElementById('on-selection'),
            cardSelected = document.getElementById('card_selected');

        buttons.forEach((btn) => {
            btn.addEventListener("click", (event) => {
                cardInput.value = event.target.value;
                cardSelected.innerText = event.target.value;
                onSelection.style.display = 'block';
            });
        });
    }

function selectCard(btn) {
        liveSend({'card': parseInt(btn.value)});
        for (let btn of buttons) {
            btn.disabled = 'disabled';
        }
    }
function selectBack(btn) {
        liveSend({'chosen_card': parseInt(btn.value)});
        for (let btn of buttons) {
            btn.disabled = 'disabled';
        }
    }
</script>
{{ endblock }}
